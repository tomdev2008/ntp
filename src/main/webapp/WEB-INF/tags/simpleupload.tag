<%@ tag language="java" pageEncoding="UTF-8"%><%@ attribute name="id" type="java.lang.String" required="true" description="上传标签id"%><%@ attribute name="exts" type="java.lang.String" required="true" description="上传文件的格式,如：*.jpg;*.png;"%><%@ attribute name="attIdName" type="java.lang.String" required="false" description="对应AttMainId的名称"%><%@ attribute name="attIdID" type="java.lang.String" required="false" description="对应AttMainId的名称"%><%@ attribute name="attIdValue" type="java.lang.String" required="false" description="对应AttMainId的值"%><%@ attribute name="filename" type="java.lang.String" required="true" description="文件名标签名称"%><%@ attribute name="filevalue" type="java.lang.String" required="true" description="文件名标签值"%><%@ attribute name="callBack" type="java.lang.String" required="false" description="回调函数"%><%@ attribute name="callBackId" type="java.lang.String" required="false" description="回调函数"%><%@ attribute name="folder" type="java.lang.String" required="false" description="两个选择项：System(默认,返回绝对路径), Folder(返回项目路径)"%><%@ attribute name="imgshow" type="java.lang.String" required="false" description="回调函数"%><%@ taglib prefix="j" uri="/WEB-INF/tld/formtag.tld"%><j:set name="ctx" value="${pageContext.request.contextPath}" /><script type="text/javascript">    var count = 0;    function callMethod(method) {        method();    }    jQuery(function() {        jQuery("#${id}").uploadify({            'height' : 27,            'width' : 80,            'buttonText' : '浏 览',            'multi' : false,            'simUploadLimit' : 1,            'swf' : '${ctx}/resources/uploadify/uploadify.swf',            'uploader' : '${ctx}/common/file/o_upload;jsessionid=${pageContext.session.id}',            'auto' : true,            'fileTypeExts' : '${exts}',            'onUploadStart' : function (file) {                jQuery("#${id}").uploadify("settings", "formData", {'folder':'${folder}'});            },            'onUploadSuccess' : function (file, data, Response) {                if (Response) {                    var objvalue = eval("(" + data + ")");                    var attId =  objvalue.attId;                    jQuery("#${attIdID}").val(attId);                    if (jQuery("#${filename}")) {                        jQuery("#${filename}").val(file.name);                    }                    if (jQuery("#${imgshow}")) {                        jQuery("#${imgshow}").attr('src', '${ctx}/common/file/image/' + attId);                    }                    if (jQuery("#imgend")) {                        jQuery("#imgend").attr('src', '${ctx}/common/file/image/' + attId);                    }                    if (jQuery("#fdIcoUrl")) {                        jQuery("#fdIcoUrl").val('common/file/image/' + attId);                    }                    <j:if test="${callBack!=null }">                    if(${callBack}){                        <j:ifelse test="${callBackId!=null }">                            <j:then>                        ${callBack}('${callBackId}',file.name);                            </j:then>                            <j:else>                        ${callBack}(attId,file.name);                            </j:else>                        </j:ifelse>                        }                   </j:if>                    count++;                }            }        });    });</script><input type="file" name="${id}" id="${id}" /><input type="hidden" name="${attIdName}" id="${attIdID}" value="${attIdValue}" /><div></div>