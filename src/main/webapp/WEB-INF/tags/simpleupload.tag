<%@ tag language="java" pageEncoding="UTF-8"%><%@ attribute name="fullname" type="java.lang.String" required="true" description="全路径标签名称"%><%@ attribute name="fullnameid" type="java.lang.String" required="true" description="全路径标签名称id"%><%@ attribute name="filename" type="java.lang.String" required="true" description="文件名标签名称"%><%@ attribute name="fullvalue" type="java.lang.String" required="true" description="全路径标签值"%><%@ attribute name="filevalue" type="java.lang.String" required="true" description="文件名标签值"%><%@ attribute name="callBack" type="java.lang.String" required="false" description="回调函数"%><%@ attribute name="callBackId" type="java.lang.String" required="false" description="回调函数"%><%@ attribute name="id" type="java.lang.String" required="true" description="上传标签id"%><%@ attribute name="folder" type="java.lang.String" required="false" description="两个选择项：System(默认,返回绝对路径), Folder(返回项目路径)"%><%@ attribute name="imgshow" type="java.lang.String" required="false" description="回调函数"%><%@ taglib prefix="j" uri="/WEB-INF/tags/formtag.tld"%><j:set name="ctx" value="${pageContext.request.contextPath}" /><script type="text/javascript">    var count = 0;    function callMethod(method) {        method();    }    jQuery(function() {        jQuery("#${id}").uploadify({            'height' : 27,            'width' : 80,            'buttonText' : '浏 览',            'multi' : false,            'simUploadLimit' : 1,            'swf' : '${ctx}/resources/uploadify/uploadify.swf',            'uploader' : '${ctx}/common/o_upload;jsessionid=${pageContext.session.id}',            'auto' : false,            'fileTypeExts' : '*.jpg;*.png;*.doc;*.docx;*.ppt;*.pptx;*.pdf;*.mmap;*.avi;*.mov;*.real;*.mpeg;*.mp4;*.flv;*.wmv;',            'onUploadStart' : function (file) {                jQuery("#${id}").uploadify("settings", "formData", {'folder':'${folder}'});            },            'onUploadSuccess' : function (file, data, Response) {                if (Response) {                	/* var attMainFileUrl = jQuery('#attMainFileUrl');                	if(attMainFileUrl){                		attMainFileUrl.val('');                	} */                    var objvalue = eval("(" + data + ")");                    // objvalue.contentType='application/octet-stream';                    if (jQuery("#${filename}")) {                        jQuery("#${filename}").val(file.name);                    }                    if (jQuery("#${imgshow}")) {                        jQuery("#${imgshow}").attr('src', '${ctx}/' + objvalue.filePath);                    }                    <j:if test="${callBack!=null }">                    if(${callBack}){                        	if(${callBackId}){                        		${callBack}('${callBackId}',file.name);	                        	}else{                        		${callBack}(file.name);                        	}                        }                   </j:if>                                       jQuery("#${fullnameid}").val(objvalue.filePath);                    count++;                }            }        });    });</script><input type="file" name="${id}" id="${id}" /><a href="javascript:$('#${id}').uploadify('upload', '*')">开始上传</a>&nbsp;<a href="javascript:$('#${id}').uploadify('cancel', '*')">取消所有上传</a><input type="hidden" id="${fullnameid}" name="${fullname}" value="${fullvalue}" />