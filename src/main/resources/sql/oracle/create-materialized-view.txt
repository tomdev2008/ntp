--创建部门信息物化视图，自动刷新
CREATE MATERIALIZED VIEW SYS_ORG_ELEMENT 
REFRESH FORCE 
ON DEMAND 
START WITH SYSDATE NEXT to_date( concat( to_char( sysdate+1,'dd-mm-yyyy'),' 01:00:00'),'dd-mm-yyyy hh24:mi:ss')
AS
SELECT E.FD_ID AS FDID, E.FD_ORG_TYPE,E.FD_NAME,E.FD_NO,E.FD_PARENTID,0 as VERSION
FROM SYS_ORG_ELEMENT@IXDF_LINK E
WHERE E.FD_ORG_TYPE IN(1,2) AND E.fd_is_available=1;


--创建人员信息物化视图，自动刷新
CREATE MATERIALIZED VIEW SYS_ORG_PERSON 
REFRESH FORCE 
ON DEMAND 
START WITH SYSDATE NEXT to_date( concat( to_char( sysdate+1,'dd-mm-yyyy'),' 01:00:00'),'dd-mm-yyyy hh24:mi:ss')
AS
SELECT P.FD_ID AS FDID,P.FD_LOGIN_NAME,P.FD_MOBILE_NO,E.FD_NO,
P.FD_EMAIL ,P.FD_PASSWORD,P.FD_ATTENDANCE_CARD_NUMBER,P.FD_WORK_PHONE,
P.FD_INIT_PASSWORD,P.FD_QQ,P.FD_MSN,P.FD_IDENTITY_CARD,P.FD_SEX,P.FD_IS_EMP,
E.FD_NAME AS REALNAME,0 as VERSION,E.FD_PARENTID AS DEPATID
FROM SYS_ORG_PERSON@IXDF_LINK P,SYS_ORG_ELEMENT@IXDF_LINK E
WHERE P.FD_ID=E.FD_ID AND E.fd_is_available=1 AND E.FD_ORG_TYPE=8;


--建立索引
create index IDX_SYS_ORG_PERSON_LOGINNAME on SYS_ORG_PERSON(FD_LOGIN_NAME);
create index IDX_SYS_ORG_PERSON_REALNAME on SYS_ORG_PERSON(REALNAME);
create index IDX_SYS_ORG_ELEMENT_FD_NAME on SYS_ORG_ELEMENT(FD_NAME);